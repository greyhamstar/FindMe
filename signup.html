<!doctype html>
<html>
<head>
<meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1">
<title>Create account</title>
<link rel="stylesheet" href="css/style.css">
</head>
<body>
<header class="container">
  <nav id="mainNav" class="nav">
    <a class="brand" href="index.html">FindMe</a>
    <button id="navToggle" class="nav-toggle" aria-label="Menu" aria-expanded="false" aria-controls="mainNav">☰</button>
    <div class="nav-items">
      <a class="chip" href="dashboard.html">Dashboard</a>
      <a class="chip" href="promoters.html" id="navPromoters">Promoters</a>
      <a class="chip" href="stores.html" id="navStores">Stores</a>
      <a class="chip" href="post_campaign.html" id="navPost">Post Campaign</a>
      <a class="chip" href="active_campaigns.html" id="navActive">Active Campaigns</a>
      <a class="chip" href="super.html" id="navSuper">Super</a>
      <a class="chip" href="signup.html" id="navCreate">Create account</a>
      <a class="chip" href="login.html" id="navLogin">Sign in</a>
      <span id="navUser" class="small"></span>
    </div>
  </nav>
</header>
<main class="container">

<style>#mainNav .nav-items .chip:not(#navLogin){display:none!important}</style>
<div class="card"><h2>Create account</h2>
  <div style="display:grid;grid-template-columns:1fr 1fr 1fr auto;gap:10px;align-items:end">
    <label class="field"><span>Role</span><select id="role"><option value="company">Company</option><option value="promoter">Promoter</option></select></label>
    <label class="field"><span>Email</span><input id="email"></label>
    <label class="field"><span>Password</span><input id="password" type="password"></label>
    <label class="field"><span id="extraLbl">Company name (if company)</span><input id="extra"></label>
    <button class="btn" id="btnCreate">Create</button>
  </div>
</div>
<script type="module">
import { signUp } from './js/offline.js';
const roleSel=document.getElementById('role'); const extraLbl=document.getElementById('extraLbl');
roleSel.onchange=()=>{ extraLbl.textContent = roleSel.value==='company' ? 'Company name (if company)' : 'Full name (Promoter)'; };
document.getElementById('btnCreate').onclick=()=>{
  const role=roleSel.value, email=document.getElementById('email').value.trim(), password=document.getElementById('password').value, extra=document.getElementById('extra').value.trim();
  try{
    if(role==='company') signUp({email,password,role,companyName:extra||null});
    else { const [firstName,...rest]=extra.split(' '); const surname=rest.join(' ')||null; signUp({email,password,role,firstName:firstName||null,surname}); }
    toast('Created ✓'); location.href='login.html';
  }catch(e){ toast(e.message||'Failed', false); }
};
</script>

</main>
<div id="toast" class="toast"></div>
<script>(function(){var nav=document.getElementById('mainNav'),btn=document.getElementById('navToggle');if(!nav||!btn)return;function t(){var o=nav.classList.toggle('open');btn.setAttribute('aria-expanded',o?'true':'false')}function c(){nav.classList.remove('open');btn.setAttribute('aria-expanded','false')}if(!btn.dataset.bnd){btn.dataset.bnd='1';btn.addEventListener('click',t)}var items=nav.querySelector('.nav-items');if(items&&!items.dataset.bnd){items.dataset.bnd='1';items.addEventListener('click',function(e){if(e.target.tagName==='A'||(e.target.closest&&e.target.closest('a'))){c()}})}})();function toast(m,o){o=o!==false;var el=document.getElementById('toast');if(!el)return;el.textContent=m;el.style.background=o?'#111':'#b00';el.classList.add('show');setTimeout(()=>el.classList.remove('show'),1600);}</script>
<script type="module">import { onAuth } from './js/offline.js'; onAuth();</script>
</body></html>