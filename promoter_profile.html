<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>FindMe! — Promoter Profile</title>
  <link rel="stylesheet" href="assets/style.css" />
</head>
<body>
  <div class="container">
    <div id="nav"></div>
    <div class="card">
      <h1>Promoter Profile</h1>
      <p class="kicker">Complete your profile to start applying</p>
      <div class="row">
        <div class="col">
          <label>Region (Province)</label>
          <select id="region"></select>
        </div>
        <div class="col">
          <label>Availability</label>
          <input id="availability" placeholder="e.g. Weekends, evenings" />
        </div>
      </div>
      <label>Skills (comma-separated)</label>
      <input id="skills" placeholder="Sampling, Roadshows, Launches" />
      <div class="toolbar">
        <button class="btn" id="saveBtn">Save Profile</button>
        <a class="btn secondary" href="promoter_dashboard.html">Skip for now</a>
      </div>
    </div>
    <footer>FindMe! MVP • LocalStorage demo</footer>
  </div>

  <script type="module">
    import { REGIONS_SA, showToast } from './js/utils.js';
    import { db } from './js/storage.js';
    import { Auth, ensureNav } from './js/auth.js';
    ensureNav();
    const me = Auth.requireAuth();
    if (me.role !== 'promoter') location.href = 'company_dashboard.html';

    const regionSel = document.querySelector('#region');
    REGIONS_SA.forEach(r => { const o = document.createElement('option'); o.value=r; o.textContent=r; regionSel.appendChild(o); });
    regionSel.value = me.region ?? REGIONS_SA[0];
    document.querySelector('#availability').value = me.availability ?? '';
    document.querySelector('#skills').value = Array.isArray(me.skills) ? me.skills.join(', ') : '';

    document.querySelector('#saveBtn').addEventListener('click', ()=>{
      const region = regionSel.value;
      const availability = document.querySelector('#availability').value.trim();
      const skills = document.querySelector('#skills').value.split(',').map(s=>s.trim()).filter(Boolean);
      db.updateById('users', me.id, (u)=> ({...u, region, availability, skills}));
      showToast('Profile saved');
      setTimeout(()=> location.href='promoter_dashboard.html', 400);
    });
  </script>
</body>
</html>
