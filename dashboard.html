<!doctype html><html lang="en"><head>
<meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover">
<title>FindMe â€” Dashboard</title>
<link rel="icon" href="assets/logo.png">
<link rel="apple-touch-icon" href="assets/icon-192.png">
<link rel="manifest" href="site.webmanifest">
<link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&family=Plus+Jakarta+Sans:wght@500;700;800&display=swap" rel="stylesheet">
<link rel="stylesheet" href="css/style.css">
</head><body>
<header class="hdr">
  <div class="brand">
    <img class="brand-logo" src="assets/logo.png" alt="FindMe logo">
    <div class="brand-text">
      <span class="brand-name">FindMe</span>
      <span class="brand-tag">Campaign Staffing</span>
    </div>
  </div>
  <div class="hdr-right">
    <nav class="nav">
  <span id="whoami" class="chip"></span>
  <a class="chip" href="index.html">Home</a>
  <a class="chip" href="post_campaign.html">Post</a>
  <a class="chip" href="promoters.html">Promoters</a>
  <button id="logoutBtn" class="btn-ghost">Logout</button>
</nav>
    <button class="btn-ghost icon" id="navToggle" aria-label="Menu">â˜°</button>
    <button id="themeToggle" class="btn-ghost" title="Toggle theme">â˜€ï¸Ž / ðŸŒ™</button>
  </div>
</header>
<main class="container">
  <div class="card" id="promoterCard">
    <h2>Promoter Dashboard</h2>
    <div class="grid grid-2"><a class="btn-ghost" href="promoter_profile.html">Update Profile</a><span></span></div>
    <h3>Campaigns in your region</h3>
    <div class="table-wrap"><table class="table" id="campaignTable"><thead><tr><th>Title</th><th>Region</th><th>Budget</th><th>Apply</th></tr></thead><tbody></tbody></table></div>
    <h3>Invitations</h3>
    <div class="table-wrap"><table class="table" id="inviteTable"><thead><tr><th>Campaign</th><th>Company</th><th>Region</th><th>Message</th><th>Status</th><th>Actions</th></tr></thead><tbody></tbody></table></div>
  </div>
  <div class="card" id="companyCard">
    <h2>Company Dashboard</h2>
    <div class="grid grid-2"><a class="btn" href="post_campaign.html">Post a Campaign</a><a class="btn-ghost" href="promoters.html">Browse Promoters</a></div>
    <h3>Your Campaigns</h3>
    <div class="table-wrap"><table class="table" id="myCampaigns"><thead><tr><th>Title</th><th>Region</th><th>Budget</th><th>Applications</th><th>Invites</th></tr></thead><tbody></tbody></table></div>
  </div>
</main>
<footer class='ftr'>Â© 2025 FindMe â€¢ All rights reserved</footer>
<script src="js/app.js"></script>
<script>
const me=getSession(); protect(me);
document.getElementById('whoami').textContent = me.role==='promoter'
  ? `${me.firstName||''} ${me.surname||''} â€” ${me.region}`.trim()
  : `${me.companyName} â€” ${me.region}`;
document.getElementById('logoutBtn').addEventListener('click', logout);
document.getElementById('promoterCard').style.display = me.role==='promoter'?'block':'none';
document.getElementById('companyCard').style.display = me.role==='company'?'block':'none';
if(me.role==='promoter'){
  const tbody=document.querySelector('#campaignTable tbody');
  tbody.innerHTML='';
  listCampaigns().filter(c=>c.region===me.region).forEach(c=>{
    const tr=document.createElement('tr');
    tr.innerHTML = `<td data-label="Title">${c.title}</td><td data-label="Region">${c.region}</td><td data-label="Budget"><span class="chip info">R ${c.budget}</span></td><td data-label="Apply"><button class="btn" data-id="${c.id}">Apply</button></td>`;
    tbody.appendChild(tr);
  });
  tbody.addEventListener('click',e=>{ if(e.target.tagName==='BUTTON'){ applyToCampaign(e.target.getAttribute('data-id'),me.id); alert('Application submitted!'); } });
  const itbody=document.querySelector('#inviteTable tbody');
  function renderInvites(){
    itbody.innerHTML='';
    invForPromoter(me.id).forEach(inv=>{
      const camp=getCampaign(inv.campaignId); const comp=getUser(inv.companyId);
      const tr=document.createElement('tr');
      tr.innerHTML=`<td data-label="Campaign">${camp?.title||'-'}</td><td data-label="Company">${comp?.companyName||'-'}</td><td data-label="Region">${camp?.region||'-'}</td><td data-label="Message">${inv.message||'-'}</td><td data-label="Status"><span class="chip ${inv.status==='accepted'?'success':inv.status==='declined'?'warn':'info'}">${inv.status}</span></td><td data-label="Actions">${inv.status==='sent'?'<button class="btn" data-act="accept" data-id="'+inv.id+'">Accept</button> <button class="btn-ghost" data-act="decline" data-id="'+inv.id+'">Decline</button>':'-'}</td>`;
      itbody.appendChild(tr);
    });
  }
  itbody.addEventListener('click',e=>{
    const act=e.target.getAttribute('data-act'); if(!act) return;
    const id=e.target.getAttribute('data-id');
    if(act==='accept'){ acceptInvite(id); const inv=getInvite(id); applyToCampaign(inv.campaignId,me.id); }
    else if(act==='decline'){ declineInvite(id); }
    renderInvites(); alert('Invitation '+act+'ed.');
  });
  renderInvites();
}
</script>
</body></html>
