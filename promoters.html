<!doctype html><html lang="en"><head>
<meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover">
<title>FindMe â€” Browse Promoters</title>
<link rel="icon" href="assets/logo.png">
<link rel="apple-touch-icon" href="assets/icon-192.png">
<link rel="manifest" href="site.webmanifest">
<link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&family=Plus+Jakarta+Sans:wght@500;700;800&display=swap" rel="stylesheet">
<link rel="stylesheet" href="css/style.css">
</head><body>
<header class="hdr">
  <div class="brand">
    <img class="brand-logo" src="assets/logo.png" alt="FindMe logo">
    <div class="brand-text">
      <span class="brand-name">FindMe</span>
      <span class="brand-tag">Campaign Staffing</span>
    </div>
  </div>
  <div class="hdr-right">
    <nav class="nav">
  <a class="chip" href="dashboard.html">Dashboard</a>
  <button id="logoutBtn" class="btn-ghost">Logout</button>
</nav>
    <button class="btn-ghost icon" id="navToggle" aria-label="Menu">â˜°</button>
    <button id="themeToggle" class="btn-ghost" title="Toggle theme">â˜€ï¸Ž / ðŸŒ™</button>
  </div>
</header>
<main class="container">
  <div class="card">
    <h2 style="margin-top:0">Browse Promoters</h2>
    <p class="small">Filter by name/email and province. Click <em>View</em> for details or <em>Invite</em> to a campaign.</p>
    <div class="grid grid-3">
      <div><label>Search</label><input id="q" placeholder="Type a name or email"/></div>
      <div><label>Region (Province)</label><select id="region"><option value="">All Regions</option><option>Eastern Cape</option><option>Free State</option><option>Gauteng</option><option>KwaZulu-Natal</option><option>Limpopo</option><option>Mpumalanga</option><option>North West</option><option>Northern Cape</option><option>Western Cape</option></select></div>
      <div class="grid" style="grid-template-columns:1fr auto; align-items:end"><button id="refreshBtn" class="btn">Apply Filters</button><button id="clearBtn" class="btn-ghost">Clear</button></div>
    </div>
    <div class="table-wrap" style="margin-top:10px">
      <table class="table" id="promoterTable">
        <thead><tr><th></th><th>Name</th><th>Region</th><th>Email</th><th>SA ID</th><th>CV</th><th>Actions</th></tr></thead>
        <tbody></tbody>
      </table>
    </div>
  </div>
</main>
<div id="detailOverlay" class="modal-overlay"><div class="modal">
  <div class="modal-header"><h3 id="detailTitle" style="margin:0">Promoter Details</h3><button class="close-x" data-close="detailOverlay">Close</button></div>
  <div id="detailBody" style="margin-top:10px"></div>
  <div class="grid" style="grid-template-columns:1fr auto; margin-top:12px"><span></span><button id="detailInviteBtn" class="btn">Invite to Campaign</button></div>
</div></div>
<div id="inviteOverlay" class="modal-overlay"><div class="modal">
  <div class="modal-header"><h3 id="inviteTitle" style="margin:0">Invite to Campaign</h3><button class="close-x" data-close="inviteOverlay">Close</button></div>
  <div id="inviteBody" style="margin-top:10px"><div class="grid grid-2"><div><label>Campaign</label><select id="inviteCampaign"></select><p class="small" id="inviteHint"></p></div><div><label>Message (optional)</label><textarea id="inviteMsg" rows="4"></textarea></div></div></div>
  <div class="grid" style="grid-template-columns:1fr auto; margin-top:12px"><span></span><button id="sendInviteBtn" class="btn">Send Invite</button></div>
</div></div>
<footer class='ftr'>Â© 2025 FindMe â€¢ All rights reserved</footer>
<script src="js/app.js"></script>
<script>
const me=getSession(); protect(me);
if(!me||me.role!=='company'){ window.location.href='dashboard.html'; }
document.getElementById('logoutBtn').addEventListener('click', logout);
const q=document.getElementById('q'), regionSel=document.getElementById('region'), tbody=document.querySelector('#promoterTable tbody');
const count=document.createElement('div'); count.className='small'; count.style.marginTop='8px'; document.querySelector('.card').appendChild(count);
function openOverlay(id){ document.getElementById(id).style.display='flex'; } function closeOverlay(id){ document.getElementById(id).style.display='none'; }
document.body.addEventListener('click',(e)=>{ const id=e.target.getAttribute('data-close'); if(id) closeOverlay(id); });
let selected=null;
function render(){ const query=q.value.trim().toLowerCase(), r=regionSel.value; const items=listPromoters().filter(p=>{ const mt=!query||(`${p.firstName||''} ${p.surname||''} ${p.email||''}`.toLowerCase().includes(query)); const mr=!r||p.region===r; return mt&&mr; }); tbody.innerHTML=''; items.forEach(p=>{ const img=p.photoFormal?`<img class="avatar-sm" src="${p.photoFormal}" alt="avatar">`:`<img class="avatar-sm" src="assets/avatar-placeholder.svg" alt="avatar">`; const tr=document.createElement('tr'); tr.innerHTML=`<td data-label="">${img}</td><td data-label="Name">${p.firstName||''} ${p.surname||''}<div class="small">${p.ethnicity||''} â€¢ ${p.gender||''}</div></td><td data-label="Region">${p.region||'-'}</td><td data-label="Email">${p.email||'-'}</td><td data-label="SA ID">${p.idNumber||'-'}</td><td data-label="CV">${p.cvName||'-'}</td><td data-label="Actions"><button class="btn" data-a="view" data-id="${p.id}">View</button> <button class="btn-ghost" data-a="invite" data-id="${p.id}">Invite</button></td>`; tbody.appendChild(tr); }); count.textContent=items.length+' promoter(s)'; }
tbody.addEventListener('click',e=>{ const a=e.target.getAttribute('data-a'); if(!a) return; const id=e.target.getAttribute('data-id'); const p=getUser(id); if(!p) return; selected=p; if(a==='view'){ detailTitle.textContent=`${p.firstName||''} ${p.surname||''}`.trim()||'Promoter Details'; const photo=p.photoFormal?`<img class="avatar" src="${p.photoFormal}" style="width:120px;height:120px;border-radius:14px;margin-bottom:10px" />`:''; detailBody.innerHTML=`${photo}<div class="grid grid-2"><div><strong>Region</strong><br>${p.region||'-'}</div><div><strong>Email</strong><br>${p.email||'-'}</div><div><strong>SA ID</strong><br>${p.idNumber||'-'}</div><div><strong>CV</strong><br>${p.cvName||'-'}</div><div><strong>Ethnicity</strong><br>${p.ethnicity||'-'}</div><div><strong>Gender</strong><br>${p.gender||'-'}</div></div>`; openOverlay('detailOverlay'); } else if(a==='invite'){ showInvite(p); }});
detailInviteBtn.addEventListener('click',()=>{ if(selected){ closeOverlay('detailOverlay'); showInvite(selected); } });
function showInvite(p){ selected=p; inviteTitle.textContent='Invite '+(p.firstName||'')+' '+(p.surname||''); const sel=inviteCampaign; sel.innerHTML=''; const c=listCampaigns().filter(x=>x.ownerId===me.id); const same=c.filter(x=>x.region===p.region), other=c.filter(x=>x.region!==p.region); const ordered=[...same,...other]; if(!ordered.length){ sel.innerHTML='<option value="">No campaigns â€” create one first.</option>'; } else { ordered.forEach(x=>{ const o=document.createElement('option'); o.value=x.id; o.textContent=`${x.title} â€” ${x.region} (R ${x.budget})`; sel.appendChild(o); }); } inviteHint.textContent=same.length?'Same-region campaigns first.':'No same-region campaigns found.'; inviteMsg.value=''; openOverlay('inviteOverlay'); }
sendInviteBtn.addEventListener('click',()=>{ const cid=inviteCampaign.value, msg=inviteMsg.value.trim(); if(!cid) return alert('Select a campaign'); sendInvite(me.id, selected.id, cid, msg); closeOverlay('inviteOverlay'); alert('Invite sent!'); });
refreshBtn.addEventListener('click',render); clearBtn.addEventListener('click',()=>{ q.value=''; region.value=''; render(); }); render();
</script>
</body></html>
